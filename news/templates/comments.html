{% load staticfiles %}

{% block comments %}
    <section id="comments" class="py-5">

        <header>
            <h2>Комментарии</h2>
        </header>

        <ul class="comments list-unstyled">
            {% for comment in comments %}
                {% if not comment.reply %}
                    <li class="comment">
                    <div class="ts-circle__sm float-left mr-4">
                        <div class="ts-img-into-bg">
                            <img
                                    {% if comment.photo %}
                                        src="{{ comment.photo.url }}"
                                    {% else %}
                                        src="{% static 'img/no-image-icon.png' %}"
                                    {% endif %}
                                        alt="">
                        </div>
                    </div>
                    <div class="comment-wrapper">
                        <div class="name pull-left">{{ comment.author }}</div>
                        <span class="date"><span class="fa fa-calendar mr-2"></span>{{ comment.added }}</span>
                        {% autoescape off %}
                            {{ comment.message }}
                        {% endautoescape %}
                        <a href="#form-news-reply" class="reply"><span class="fa fa-reply mr-2"></span>Ответить</a>
                        <hr>
                    </div>
                </li>
                {% endif %}
                <li>
                {% for subcomment in comments %}
                    {% if subcomment.reply == comment  %}
                        <ul class="comments-child">
                            <li class="comment">
                                <div class="ts-circle__sm float-left mr-4">
                                    <div class="ts-img-into-bg">
                                        <img
                                                {% if subcomment.photo %}
                                                    src="{{ subcomment.photo.url }}"
                                                {% else %}
                                                    src="{% static 'img/no-image-icon.png' %}"
                                                {% endif %}
                                                    alt="">
                                    </div>
                                </div>
                                <div class="comment-wrapper">
                                    <div class="name">{{ subcomment.author }}</div>
                                    <span class="date"><span class="fa fa-calendar mr-2"></span>{{ subcomment.added }}</span>
                                    {% autoescape off %}
                                        {{ subcomment.message }}
                                    {% endautoescape %}
                                    <a href="#form-news-reply"
                                       class="reply"><span class="fa fa-reply mr-2"></span>Ответить</a>
                                    <hr>
                                </div>
                            </li>
                        </ul>
                    {% endif %}
                {% endfor %}
                </li>
            {% endfor %}
        </ul>
    </section>

    <section id="leave-reply" class="py-5">
        <header><h2 class="no-border">Оставить комментарий</h2></header>
        <form role="form" id="form-news-reply" method="post"
              class="clearfix ts-form-comment" data-path="/news/{{ news.id }}/comment/">
            {% csrf_token %}
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="form-news-reply-name">Ваше имя<em>*</em></label>
                        <input type="text" class="form-reply form-control" id="form-news-reply-name" name="form-news-reply-name" required>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label for="form-news-reply-email">Ваш e-mail<em>*</em></label>
                        <input type="email" class="form-reply form-control" id="form-news-reply-email" name="form-news-reply-email" required>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="form-news-reply-message">Ваше сообщение<em>*</em></label>
                        <textarea class="form-reply form-control" id="form-news-reply-message" rows="5" name="form-news-reply-message" required></textarea>
                    </div>
                </div>
            </div>
            <div class="form-group clearfix">
                <button type="submit" class="btn btn-primary" id="form-news-reply-submit">Отправить</button>
            </div>
            <div id="form-rating-status"></div>
        </form>
    </section>
{% endblock comments %}